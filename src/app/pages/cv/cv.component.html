<div class="cv-shell bg-white lg:bg-gray-800">
  @if (isLoading()) {
    <div class="flex min-h-screen items-center justify-center py-12">
      <p class="text-lg text-gray-600">Loading curriculum data...</p>
    </div>
  } @else if (!curriculum()) {
    <div class="flex min-h-screen items-center justify-center py-12">
      <p class="text-lg text-red-600">Failed to load curriculum data</p>
    </div>
  } @else {
    <div class="cv-frame">
      <article class="cv-page">
        <div class="flex flex-col-reverse lg:flex-row">
          <aside class="w-full bg-slate-700 p-8 text-white lg:w-[30%] lg:p-14">
            <div class="mb-12">
              <h2 class="mb-6 text-2xl font-bold">Contact</h2>
              <div class="mb-8 space-y-3">
                <div class="flex items-center gap-3">
                  <mat-icon class="text-blue-100">phone</mat-icon>
                  <a [href]="'tel:' + personalInfo()?.phone" class="text-white transition hover:text-blue-100">{{ personalInfo()?.phone }}</a>
                </div>
                <div class="flex items-center gap-3">
                  <mat-icon class="text-blue-100">email</mat-icon>
                  <a href="mailto:js-julian.salinas@outlook.com" class="text-white transition hover:text-blue-100">js-julian.salinas@outlook.com</a>
                </div>
                <div class="flex items-center gap-3">
                  <mat-icon class="text-blue-100">code</mat-icon>
                  <a href="https://github.com/JulianSalinas" target="_blank" class="text-white transition hover:text-blue-100">github.com/JulianSalinas</a>
                </div>
                <div class="flex items-center gap-3">
                  <mat-icon class="text-blue-100">business</mat-icon>
                  <a href="https://linkedin.com/in/JulianSalinas" target="_blank" class="text-white transition hover:text-blue-100">linkedin.com/in/JulianSalinas</a>
                </div>
              </div>
              <mat-divider class="mb-6 bg-blue-400"></mat-divider>
            </div>

            <div class="mb-12">
              <h2 class="mb-6 text-2xl font-bold">Languages</h2>
              <div class="mb-8 space-y-4">
                @for (language of languages(); track language.name) {
                  <div class="flex items-center justify-between">
                    <span class="font-semibold">{{ language.name }}</span>
                    <span class="text-sm text-blue-100">{{ language.level }}</span>
                  </div>
                }
              </div>
              <mat-divider class="mb-6 mt-6 bg-blue-400"></mat-divider>
            </div>

            <div class="mb-12">
              <h2 class="mb-6 text-2xl font-bold">Technologies</h2>
              <div class="space-y-4">
                @for (group of technologyGroups(); track group.category) {
                  <div class="mb-6">
                    <h3 class="mb-3 text-sm font-bold uppercase tracking-wide text-blue-100">{{ group.category }}</h3>
                    @for (tech of group.technologies; track tech.name) {
                      <div class="mb-4">
                        <div class="mb-2 flex items-start justify-between">
                          <span class="text-sm font-semibold">{{ tech.name }}</span>
                        </div>
                        <div class="h-4 w-full overflow-hidden rounded bg-slate-300/60">
                          <div
                            class="h-full rounded bg-blue-400"
                            [style.width.%]="tech.proficiency * 20"
                            aria-hidden="true"
                          ></div>
                        </div>
                      </div>
                    }
                  </div>
                }
              </div>
            </div>
          </aside>

          <main class="w-full bg-white p-8 lg:w-[70%] lg:p-16">
            <section class="mb-12">
              <h1 class="mb-6 text-5xl font-bold text-gray-900 lg:text-7xl">{{ personalInfo()?.name }}</h1>
              <p class="mb-6 text-2xl font-semibold text-gray-500">{{ personalInfo()?.role }}</p>
              <p class="mb-8 text-lg leading-relaxed text-gray-700">{{ personalInfo()?.profile }}</p>
              <mat-divider class="my-8"></mat-divider>
            </section>

            <section class="mb-12">
              <h2 class="mb-8 text-3xl font-bold text-gray-900">Work Experience</h2>
              <div class="relative">
                <div class="absolute bottom-0 left-3 top-0 w-px bg-gray-300"></div>
                <div class="space-y-8">
                  @for (job of workExperience(); track job.id) {
                    <div class="relative pl-12">
                      <span class="absolute left-3 top-2 h-3 w-3 -translate-x-1/2 rounded-full bg-blue-500 ring-4 ring-blue-50"></span>
                      <div>
                        <h3 class="text-xl font-bold text-gray-900">
                          {{ job.position }}
                          @if (job.company) {
                            <span class="text-gray-600"> at {{ job.company }}</span>
                          }
                        </h3>
                        @if (job.roles && job.roles.length > 0) {
                          <div class="mt-2 space-y-1">
                            @for (role of job.roles; track role.position + role.startDate + role.endDate) {
                              <p class="text-sm text-gray-500">
                                <span class="font-semibold text-gray-600">{{ role.position }}</span>
                                <span> | {{ role.startDate }} - {{ role.endDate }}</span>
                              </p>
                            }
                          </div>
                        } @else {
                          <p class="mt-1 text-sm text-gray-500">{{ job.startDate }} - {{ job.endDate }}</p>
                        }
                        @if (job.client) {
                          <p class="mt-1 text-sm text-gray-500">Client: {{ job.client }}</p>
                        }
                        @if (job.highlights.length > 0) {
                          <ul class="ml-4 mt-3 list-inside list-disc space-y-1">
                            @for (highlight of job.highlights; track highlight) {
                              <li class="text-sm text-gray-700">{{ highlight }}</li>
                            }
                          </ul>
                        }
                      </div>
                    </div>
                  }
                </div>
              </div>
            </section>

            <section class="mb-12">
              <h2 class="mb-8 text-3xl font-bold text-gray-900">Education</h2>
              <div class="grid grid-cols-1 gap-6">
                @for (edu of education(); track edu.institution) {
                  <div class="rounded-lg border border-gray-200 p-6 transition-all hover:border-blue-300 hover:shadow-lg">
                    <div class="flex items-start gap-4">
                      <div class="flex items-center justify-center overflow-hidden">
                        @if (edu.icon) {
                          <img src="{{ edu.icon }}" alt="{{ edu.institution }}" class="h-16 w-16 object-contain" />
                        } @else {
                          <mat-icon class="icon-2x text-blue-600">school</mat-icon>
                        }
                      </div>
                      <div class="flex-1">
                        <h3 class="text-lg font-bold text-gray-900">{{ edu.degree }}</h3>
                        <p class="mt-1 text-sm font-semibold text-gray-500">{{ edu.institution }}</p>
                        <div class="mt-3 border-t border-gray-100 pt-3">
                          <p class="text-sm text-gray-600">{{ edu.startDate }} - {{ edu.endDate }}</p>
                        </div>
                      </div>
                    </div>
                  </div>
                }
              </div>
            </section>
            
            <section>
              <h2 class="mb-8 text-3xl font-bold text-gray-900">Certifications</h2>
              <div class="grid grid-cols-1 gap-6 md:grid-cols-2">
                @for (cert of certifications(); track cert.name) {
                  <div class="rounded-lg border border-gray-200 p-6 transition-all hover:border-blue-300 hover:shadow-lg">
                    <div class="flex items-start gap-4">
                      <div class="flex items-center justify-center overflow-hidden">
                        @if (cert.icon) {
                          <img src="{{ cert.icon }}" alt="{{ cert.issuer }}" class="h-16 w-16 object-contain" />
                        } @else {
                          <mat-icon class="icon-2x text-blue-600">verified</mat-icon>
                        }
                      </div>
                      <div class="flex-1">
                        <h3 class="text-lg font-bold text-gray-900">{{ cert.name }}</h3>
                        <div class="mt-1 flex items-center gap-2">
                          <p class="text-sm font-semibold text-gray-500">{{ cert.issuer }}</p>
                        </div>
                        <div class="mt-3 border-t border-gray-100 pt-3">
                          @if (cert.date || cert.location) {
                            <p class="text-sm text-gray-600">
                              @if (cert.date) {
                                {{ cert.date }}
                              }
                              @if (cert.date && cert.location) {
                                <span>, </span>
                              }
                              @if (cert.location) {
                                {{ cert.location }}
                              }
                            </p>
                          }
                        </div>
                      </div>
                    </div>
                  </div>
                }
              </div>
            </section>
          </main>
        </div>
      </article>
    </div>
  }
</div>
